#name: Test

#on:
#  push:
#    branches: [ "main" ]
#
#jobs:
#  build:
#
#    runs-on: ubuntu-latest
#
#    steps:
#    - uses: actions/checkout@v4
#
#    - name: Deploy via FTP
#      uses: SamKirkland/FTP-Deploy-Action@4.3.5
#      with:
#        server: ${{ secrets.HOST }}
#        username: ${{ secrets.NAME }}
#        password: ${{ secrets.PASS }}
#        local-dir: ./
#        server-dir: /www/cheese_api/
#        protocol: ftps
#        security: strict

on: push
name: ðŸš€ Deploy website on push
jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest
    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v4

    - name: ðŸ“‚ Install lftp
      run: sudo apt-get update && sudo apt-get install -y lftp

    - name: ðŸ”„ Deploy via lftp
      run: |
        lftp -u "${{ secrets.NAME }},${{ secrets.PASS }}" ${{ secrets.HOST }} <<EOF
        set ftp:ssl-force true
        set ftp:ssl-protect-data true
        mirror -R --only-newer --parallel=5 ./ /www/cheese_api/
        quit
        EOF
    


